import{Q as E}from"./qrcode.vue.esm-c053d461.js";import{d as U,r as i,am as b,an as w,m as o,o as u,e as _,q as t,c as j,x as c,M as p,z as D,a as s,ao as I,ap as Q,aq as G,N as C,g as P}from"./index-9f7c584d.js";const T={key:0},F={name:"Me2Auth"},H=U({...F,setup(J){const m=i({secret:"",url:""}),f=i(!1),r=i(!1),l=i(!1),v=i({secret:"",code:""}),g=i(null),O={code:[{required:!0}]},x=e=>{I({status:e?1:2}).catch(()=>{f.value=!e})};b().then(e=>{r.value=e.isSetted,f.value=e.isOpened,r.value||w().then(a=>{m.value=a,l.value=!0})});const V=()=>{w().then(e=>{m.value=e,l.value=!0})},y=()=>{g.value.validate({showErrorMessage:!0}).then(async e=>{var a,n;if(e===!0){r.value?await Q({code:v.value.code,secret:m.value.secret}):await G({code:v.value.code,secret:m.value.secret});const d=await b();r.value=d.isSetted,f.value=d.isOpened,l.value=!1,C.success("操作成功");return}if(e&&Object.keys(e).length){const d=(n=(a=Object.values(e)[0])==null?void 0:a[0])==null?void 0:n.message;C.warning(d)}})},M=()=>{g.value.reset(),l.value=!1};return(e,a)=>{const n=o("t-button"),d=o("t-switch"),S=o("t-icon"),k=o("t-form-item"),A=o("t-input"),q=o("t-link"),z=o("t-form"),N=o("t-space"),B=o("t-card");return u(),_(B,{class:"user-info-list",title:"二步校验",bordered:!1},{actions:t(()=>[r.value?(u(),j("div",T,[l.value===!0?(u(),_(n,{key:0,onClick:y},{default:t(()=>[c("提交")]),_:1})):p("",!0),l.value===!0?(u(),_(n,{key:1,onClick:M},{default:t(()=>[c("取消")]),_:1})):p("",!0),l.value===!1?(u(),_(d,{key:2,modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=h=>f.value=h),size:"large",onChange:x},{label:t(h=>[c(D(h.value?"开":"关"),1)]),_:1},8,["modelValue"])):p("",!0),s(n,{theme:"default",shape:"square",variant:"text",onClick:V},{default:t(()=>[s(S,{name:"filter-2"})]),_:1})])):p("",!0),r.value?p("",!0):(u(),_(n,{key:1,theme:"primary",onClick:y},{default:t(()=>[c(" 设置 ")]),_:1}))]),default:t(()=>[l.value?(u(),_(N,{key:0,direction:"vertical",size:"large",style:{width:"100%","margin-top":"20px"}},{default:t(()=>[s(z,{ref_key:"form",ref:g,rules:O,data:v.value,"scroll-to-first-error":"smooth",layout:"inline"},{default:t(()=>[s(k,{label:"二维码"},{default:t(()=>[s(E,{value:m.value.url,size:100},null,8,["value"])]),_:1}),s(k,{label:"校验码",name:"code"},{default:t(()=>[s(A,{modelValue:v.value.code,"onUpdate:modelValue":a[1]||(a[1]=h=>v.value.code=h),modelModifiers:{trim:!0},type:"number"},null,8,["modelValue"])]),_:1}),s(k,{label:"温馨提示：","label-width":"72px"},{default:t(()=>[c(" 使用"),s(q,{theme:"success",target:"_blank",href:"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en_US"},{default:t(()=>[c("Google Authenticator App")]),_:1}),c("扫码获取校验码，输入提交校验 ")]),_:1})]),_:1},8,["data"])]),_:1})):p("",!0)]),_:1})}}});const W=P(H,[["__scopeId","data-v-4c4729d6"]]);export{W as default};
