import{d as E,at as I,u as O,r as p,i as C,j as W,a2 as j,m as l,o as q,c as K,a as e,q as o,v as s,Q as x,x as i,b as Q,av as G,N as H,g as J}from"./index-9f7c584d.js";import{C as X}from"./constants-ff30c5f4.js";const Y={class:"list-common-table"},Z={class:"table-container"},ee="index",te="top",oe=!0,ae=E({__name:"CommonTable",setup(ne){const t=I(),k=O();t.setPagination({current:1,pageSize:20});const _=p(null),c=p(!1),d=p(-1),V=C(()=>d.value>-1?"删除后，api关联权限将被清空，且无法恢复":""),f=()=>{d.value=-1},A=async()=>{await G(d.value),c.value=!1,H.success("删除成功"),f(),t.getApiList()},S=()=>{f()};W(()=>{t.getApiList()});const w=a=>{d.value=a.row.id,c.value=!0},L=a=>{_.value.reset(),console.log(a)},g=()=>{t.getApiList()},D=(a,n)=>{console.log("分页变化",a,n),t.setPagination({...t.pagination,current:a.current,pageSize:a.pageSize}),g()},T=(a,n)=>{console.log("统一Change",a,n)},F=a=>{t.setCurrentRow(a.row),U()},N=C(()=>({offsetTop:k.isUseTabsRouter?48:0,container:`.${j}-layout`})),P=()=>{t.setAddVisible(!0)},U=()=>{t.setEditVisible(!0)};return(a,n)=>{const v=l("t-input"),h=l("t-form-item"),u=l("t-col"),b=l("t-row"),m=l("t-button"),z=l("t-form"),y=l("t-link"),B=l("t-space"),M=l("t-table"),R=l("t-dialog");return q(),K("div",Y,[e(z,{ref_key:"form",ref:_,data:s(t).searchFormData,"label-width":80,colon:"",onReset:L,onSubmit:g},{default:o(()=>[e(b,null,{default:o(()=>[e(u,{span:10},{default:o(()=>[e(b,{gutter:[24,24]},{default:o(()=>[e(u,{span:4},{default:o(()=>[e(h,{label:"url",name:"url"},{default:o(()=>[e(v,{modelValue:s(t).searchFormData.url,"onUpdate:modelValue":n[0]||(n[0]=r=>s(t).searchFormData.url=r),class:"form-item-content",type:"search",placeholder:"请输入url",style:{minWidth:"134px"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:4},{default:o(()=>[e(h,{label:"group",name:"group"},{default:o(()=>[e(v,{modelValue:s(t).searchFormData.group,"onUpdate:modelValue":n[1]||(n[1]=r=>s(t).searchFormData.group=r),class:"form-item-content",type:"search",placeholder:"请输入group",style:{minWidth:"134px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{span:2,class:"operation-container"},{default:o(()=>[e(m,{theme:"primary",type:"button",style:x({marginLeft:"var(--td-comp-margin-s)"}),onClick:P},{default:o(()=>[i(" 添加 ")]),_:1},8,["style"]),e(m,{theme:"primary",type:"submit",style:x({marginLeft:"var(--td-comp-margin-s)"})},{default:o(()=>[i(" 查询 ")]),_:1},8,["style"]),e(m,{type:"reset",variant:"base",theme:"default"},{default:o(()=>[i(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),Q("div",Z,[e(M,{data:s(t).apiList,columns:s(X),"row-key":ee,"vertical-align":te,hover:oe,pagination:s(t).pagination,loading:s(t).dataLoading,"header-affixed-top":N.value,onPageChange:D,onChange:T},{op:o(r=>[e(B,null,{default:o(()=>[e(y,{theme:"primary",onClick:$=>F(r)},{default:o(()=>[i("编辑")]),_:2},1032,["onClick"]),e(y,{theme:"danger",onClick:$=>w(r)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","columns","pagination","loading","header-affixed-top"]),e(R,{visible:c.value,"onUpdate:visible":n[2]||(n[2]=r=>c.value=r),header:"确认删除当前API？",body:V.value,"on-cancel":S,onConfirm:A},null,8,["visible","body"])])])}}});const re=J(ae,[["__scopeId","data-v-ec5ceee3"]]);export{re as default};
