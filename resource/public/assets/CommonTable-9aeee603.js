import{d as P,a5 as j,u as q,r as f,i as x,j as I,a2 as Q,m as i,o as G,c as H,a as e,q as o,v as l,Q as k,x as r,b as J,a8 as X,N as Y,g as Z}from"./index-812ea633.js";import{C as ee}from"./constants-bac3fbcd.js";const te={class:"list-common-table"},oe={class:"table-container"},ae="index",ne="top",le=!0,se=P({__name:"CommonTable",setup(ie){const V={value:"configValue",label:"configKey"},t=j(),F=q();t.getFileTypeList();const g=f(null),d=f(!1),m=f(-1),w=x(()=>m.value>-1?"删除后，文件无法恢复":""),h=()=>{m.value=-1},L=async()=>{await X(m.value),d.value=!1,Y.success("删除成功"),h(),t.getFileList()},S=()=>{h()};I(()=>{t.getFileList()});const D=a=>{m.value=a.row.id,d.value=!0},T=a=>{g.value.reset(),console.log(a)},v=()=>{t.getFileList()},N=(a,n)=>{console.log("分页变化",a,n),t.setPagination({...t.pagination,current:a.current,pageSize:a.pageSize}),v()},U=(a,n)=>{console.log("统一Change",a,n)},$=a=>{t.setCurrentRow(a.row),M()},B=a=>{console.log(a),window.open(`http://127.0.0.1:8888/upload/${a.row.fileUrl}`,"_blank")},z=x(()=>({offsetTop:F.isUseTabsRouter?48:0,container:`.${Q}-layout`})),A=()=>{t.setAddVisible(!0)},M=()=>{t.setEditVisible(!0)};return(a,n)=>{const O=i("t-select"),u=i("t-form-item"),c=i("t-col"),y=i("t-input"),b=i("t-row"),p=i("t-button"),R=i("t-form"),_=i("t-link"),W=i("t-space"),E=i("t-table"),K=i("t-dialog");return G(),H("div",te,[e(R,{ref_key:"form",ref:g,data:l(t).searchFormData,"label-width":80,colon:"",onReset:T,onSubmit:v},{default:o(()=>[e(b,null,{default:o(()=>[e(c,{span:10},{default:o(()=>[e(b,{gutter:[24,24]},{default:o(()=>[e(c,{span:4},{default:o(()=>[e(u,{label:"上传驱动",name:"drive"},{default:o(()=>[e(O,{modelValue:l(t).searchFormData.drive,"onUpdate:modelValue":n[0]||(n[0]=s=>l(t).searchFormData.drive=s),keys:V,options:l(t).fileTypeList,placeholder:"请选择驱动",style:{minWidth:"134px"},type:"search"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(c,{span:4},{default:o(()=>[e(u,{label:"原始文件名",name:"originName"},{default:o(()=>[e(y,{modelValue:l(t).searchFormData.originName,"onUpdate:modelValue":n[1]||(n[1]=s=>l(t).searchFormData.originName=s),class:"form-item-content",type:"search",placeholder:"请输入原始文件名",style:{minWidth:"134px"}},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:4},{default:o(()=>[e(u,{label:"文件后缀",name:"ext"},{default:o(()=>[e(y,{modelValue:l(t).searchFormData.ext,"onUpdate:modelValue":n[2]||(n[2]=s=>l(t).searchFormData.ext=s),class:"form-item-content",type:"search",placeholder:"请输入文件后缀",style:{minWidth:"134px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{span:2,class:"operation-container"},{default:o(()=>[e(p,{theme:"primary",type:"button",style:k({marginLeft:"var(--td-comp-margin-s)"}),onClick:A},{default:o(()=>[r(" 上传 ")]),_:1},8,["style"]),e(p,{theme:"primary",type:"submit",style:k({marginLeft:"var(--td-comp-margin-s)"})},{default:o(()=>[r(" 查询 ")]),_:1},8,["style"]),e(p,{type:"reset",variant:"base",theme:"default"},{default:o(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),J("div",oe,[e(E,{data:l(t).fileList,columns:l(ee),"row-key":ae,"vertical-align":ne,hover:le,pagination:l(t).pagination,loading:l(t).dataLoading,"header-affixed-top":z.value,onPageChange:N,onChange:U},{op:o(s=>[e(W,null,{default:o(()=>[e(_,{theme:"primary",onClick:C=>B(s)},{default:o(()=>[r("预览")]),_:2},1032,["onClick"]),e(_,{theme:"primary",onClick:C=>$(s)},{default:o(()=>[r("编辑")]),_:2},1032,["onClick"]),e(_,{theme:"danger",onClick:C=>D(s)},{default:o(()=>[r("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","columns","pagination","loading","header-affixed-top"]),e(K,{visible:d.value,"onUpdate:visible":n[3]||(n[3]=s=>d.value=s),header:"确认删除当前文件？",body:w.value,"on-cancel":S,onConfirm:L},null,8,["visible","body"])])])}}});const de=Z(se,[["__scopeId","data-v-c6c59c9f"]]);export{de as default};
