import{d as $,aj as w,at as A,r as p,w as C,aV as V,m as i,o as P,c as S,a as r,q as d,v as x,aW as B,N as R}from"./index-9f7c584d.js";function y(u){return u.reduce((n,e)=>{const t=n.find(s=>s.group===e.group);return t?t.children.push({label:`${e.url}-${e.method}`,value:`${e.url}-${e.method}`}):n.push({group:e.group,children:[{label:`${e.url}-${e.method}`,value:`${e.url}-${e.method}`}]}),n},[])}const z=$({__name:"AuthApi",setup(u){const n=w(),e=A(),t=p([]),s=p();e.setPagination({current:1,pageSize:9999}),e.getApiList().then(()=>{t.value=y(e.apiList)}),C(()=>n.apiPermissionVisible,l=>{l&&V(n.currentRow.id).then(o=>{console.log(o,555555),s.value=o.list.map(a=>`${a.url}-${a.method}`)})});const c=()=>{n.setApiPermissionVisible(!1)},h=async()=>{await B(n.currentRow.id,s.value.map(l=>{const o=l.split("-");return{url:o[0],method:o[1]}})),R.success("设置成功").then(),c()},g=(l,o)=>(console.log("filter:",l,o),o.label.indexOf(l)!==-1),m=l=>{console.log("handleBlur: ",l.value,l.e)},_=(l,o)=>{console.log("handleChange: ",l,o)};return(l,o)=>{const a=i("t-select"),f=i("t-space"),v=i("t-dialog");return P(),S("div",null,[r(v,{size:"large",visible:x(n).apiPermissionVisible,header:"API权限设置","on-confirm":h,onClose:c},{default:d(()=>[r(f,{direction:"vertical",size:"large",style:{width:"100%"}},{default:d(()=>[r(a,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=b=>s.value=b),"min-collapsed-num":2,options:t.value,multiple:"",placeholder:"-请选择-",filter:g,style:{width:"400px",display:"inline-block"},onBlur:m,onChange:_},null,8,["modelValue","options"])]),_:1})]),_:1},8,["visible"])])}}});export{z as _};
