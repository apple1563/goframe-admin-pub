import{Q as $}from"./qrcode.vue.esm-fb111f65.js";import{d as F,I as M,r as _,J as D,K as E,m as c,o as r,c as w,v as I,e as b,q as o,F as h,a as e,b as u,x as g,M as m,s as S,N as P,p as Q,f as j,g as G}from"./index-fd6a2e45.js";const z=f=>(Q("data-v-68d8f97f"),f=f(),j(),f),H={class:"check-container remember-pwd"},J=z(()=>u("span",{class:"tip"},"忘记账号？",-1)),K={class:"tip-container"},W=z(()=>u("span",{class:"tip"},"请使用微信扫一扫登录",-1)),X={class:"refresh"},Y={class:"switch-container"},Z=F({__name:"Login",setup(f){const d=M(),q={account:"root",password:"1"},N={account:[{required:!0,message:"账号必填",type:"error"}],password:[{required:!0,message:"密码必填",type:"error"}]},k=_(""),s=_("password"),R=_(),a=_({...q}),v=_(!1),U=n=>{s.value=n},L=D(),A=E(),B=async n=>{n.validateResult===!0&&(await d.login(a.value),d.isOpened||x())};function x(){P.success("登录成功");const n=A.query.redirect,t=n?decodeURIComponent(n):"/dashboard";L.push(t)}const O=async()=>{await d.login2step({username:a.value.account,code:k.value}),x()};return(n,t)=>{const i=c("t-icon"),y=c("t-input"),p=c("t-form-item"),T=c("t-checkbox"),V=c("t-button"),C=c("t-form");return r(),w(h,null,[I(d).isOpened?m("",!0):(r(),b(C,{key:0,ref_key:"form",ref:R,class:S(["item-container",`login-${s.value}`]),data:a.value,rules:N,"label-width":"0",onSubmit:B},{default:o(()=>[s.value=="password"?(r(),w(h,{key:0},[e(p,{name:"account"},{default:o(()=>[e(y,{modelValue:a.value.account,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.account=l),size:"large",placeholder:"请输入账号："},{"prefix-icon":o(()=>[e(i,{name:"user"})]),_:1},8,["modelValue"])]),_:1}),e(p,{name:"password"},{default:o(()=>[e(y,{modelValue:a.value.password,"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.password=l),size:"large",type:v.value?"text":"password",clearable:"",placeholder:"请输入登录密码："},{"prefix-icon":o(()=>[e(i,{name:"lock-on"})]),"suffix-icon":o(()=>[e(i,{name:v.value?"browse":"browse-off",onClick:t[1]||(t[1]=l=>v.value=!v.value)},null,8,["name"])]),_:1},8,["modelValue","type"])]),_:1}),u("div",H,[e(T,null,{default:o(()=>[g("记住账号")]),_:1}),J])],64)):s.value=="qrcode"?(r(),w(h,{key:1},[u("div",K,[W,u("span",X,[g("刷新 "),e(i,{name:"refresh"})])]),e($,{value:"",size:160,level:"H"})],64)):m("",!0),s.value!=="qrcode"?(r(),b(p,{key:2,class:"btn-container"},{default:o(()=>[e(V,{block:"",size:"large",type:"submit"},{default:o(()=>[g(" 登录 ")]),_:1})]),_:1})):m("",!0),u("div",Y,[s.value!=="password"?(r(),w("span",{key:0,class:"tip",onClick:t[3]||(t[3]=l=>U("password"))},"使用账号密码登录")):m("",!0)])]),_:1},8,["class","data"])),I(d).isOpened?(r(),b(C,{key:1,class:S(["item-container",`login-${s.value}`]),"label-width":"0"},{default:o(()=>[e(p,{tips:"打开Google Authenticator获取验证码输入"},{default:o(()=>[e(y,{modelValue:k.value,"onUpdate:modelValue":t[4]||(t[4]=l=>k.value=l),size:"large",placeholder:"请输入谷歌验证码："},{"prefix-icon":o(()=>[e(i,{name:"lock-on"})]),_:1},8,["modelValue"])]),_:1}),e(p,{class:"btn-container"},{default:o(()=>[e(V,{block:"",size:"large",type:"button",onClick:O},{default:o(()=>[g(" 登录 ")]),_:1})]),_:1})]),_:1},8,["class"])):m("",!0)],64)}}});const te=G(Z,[["__scopeId","data-v-68d8f97f"]]);export{te as default};
