import{T as B,E as O}from"./index.esm-3436990c.js";import{d as j,aM as L,ai as M,r as p,w as T,aN as z,j as F,aO as q,m as u,o as v,c as b,a as t,q as n,v as d,F as A,t as D,e as J,b as P,aT as G,N as g}from"./index-fd6a2e45.js";import{R as H}from"./constants-e39b1224.js";const I={style:{border:"1px solid #ccc"}},Y=j({__name:"EditNotice",setup(K){const r=L(),V=M(),c=p(null),e=p({tag:"",content:"",title:"",sort:0,remark:"",receivers:[]});T(()=>r.editVisible,a=>{a&&(e.value.content=r.currentRow.content,e.value.title=r.currentRow.title,e.value.tag=r.currentRow.tag,e.value.sort=r.currentRow.sort,e.value.remark=r.currentRow.remark,e.value.receivers=JSON.parse(r.currentRow.receivers))});const f=()=>{r.setEditVisible(!1)},w=()=>{c.value.reset()},k=()=>{c.value.validate({showErrorMessage:!0}).then(async a=>{var l,i;if(a===!0){await G({title:e.value.title,content:e.value.content,remark:e.value.remark,receivers:e.value.receivers,tag:e.value.tag,sort:e.value.sort}),g.success("修改成功"),r.getNoticeList(),f();return}if(a&&Object.keys(a).length){const s=(i=(l=Object.values(a)[0])==null?void 0:l[0])==null?void 0:i.message;g.warning(s)}})},m=z(),h=p("<p>hello</p>");F(()=>{setTimeout(()=>{h.value="<p>模拟 Ajax 异步设置内容</p>"},1500)});const y={},C={placeholder:"请输入内容..."};q(()=>{const a=m.value;a!=null&&a.destroy()});const N=a=>{m.value=a};return(a,l)=>{const i=u("t-input"),s=u("t-form-item"),_=u("t-option"),U=u("t-select"),x=u("t-input-number"),E=u("t-form"),R=u("t-space"),S=u("t-dialog");return v(),b("div",null,[t(S,{size:"large",width:"800px",visible:d(r).editVisible,header:"修改通知","on-confirm":k,onClose:f},{default:n(()=>[t(R,{direction:"vertical",size:"large",style:{width:"100%"}},{default:n(()=>[t(E,{ref_key:"form",ref:c,data:e.value,rules:d(H),onReset:w},{default:n(()=>[t(s,{label:"标题",name:"title"},{default:n(()=>[t(i,{modelValue:e.value.title,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.title=o),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(s,{label:"标签",name:"tag"},{default:n(()=>[t(i,{modelValue:e.value.tag,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.tag=o),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(s,{label:"接收者",name:"tag"},{default:n(()=>[t(U,{modelValue:e.value.receivers,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.receivers=o),"min-collapsed-num":6,placeholder:"请选择接收者",multiple:"",filterable:""},{default:n(()=>[t(_,{label:"全选","check-all":!0}),(v(!0),b(A,null,D(d(V).userList,o=>(v(),J(_,{key:o.id,value:o.id,label:o.username},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"内容",name:"content"},{default:n(()=>[P("div",I,[t(d(B),{style:{"border-bottom":"1px solid #ccc"},editor:m.value,"default-config":y,mode:"default"},null,8,["editor"]),t(d(O),{modelValue:e.value.content,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.content=o),style:{height:"240px","overflow-y":"hidden"},"default-config":C,mode:"default",onOnCreated:N},null,8,["modelValue"])])]),_:1}),t(s,{label:"排序",name:"sort"},{default:n(()=>[t(x,{modelValue:e.value.sort,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.sort=o),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(s,{label:"备注",name:"remark"},{default:n(()=>[t(i,{modelValue:e.value.remark,"onUpdate:modelValue":l[5]||(l[5]=o=>e.value.remark=o),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["data","rules"])]),_:1})]),_:1},8,["visible"])])}}});export{Y as _};
