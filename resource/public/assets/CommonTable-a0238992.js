import{g as Q}from"./list-5042c18a.js";import{T as P}from"./index-20ecc31f.js";import{d as J,u as Z,r as m,i as A,j as ee,a2 as te,m as n,o as c,c as p,a as t,q as e,v as s,ag as ae,ah as oe,Q as le,x as i,b as ne,ad as v,e as g,M as d,ae as k,af as U,N as se,g as ce}from"./index-fd6a2e45.js";const ie={class:"list-common-table"},ue={class:"table-container"},de={key:0},re={key:1},me={key:2},pe={key:0,class:"payment-col"},_e={key:1,class:"payment-col"},fe="index",ye="top",ve=!0,ge=J({__name:"CommonTable",setup(he){const w=Z(),O=[{title:"合同名称",fixed:"left",width:280,ellipsis:!0,align:"left",colKey:"name"},{title:"合同状态",colKey:"status",width:160},{title:"合同编号",width:160,ellipsis:!0,colKey:"no"},{title:"合同类型",width:160,ellipsis:!0,colKey:"contractType"},{title:"合同收付类型",width:160,ellipsis:!0,colKey:"paymentType"},{title:"合同金额 (元)",width:160,ellipsis:!0,colKey:"amount"},{align:"left",fixed:"right",width:160,colKey:"op",title:"操作"}],u=m({...{name:"",no:"",type:""}}),h=m({defaultPageSize:20,total:100,defaultCurrent:1}),T=m(!1),_=m([]),b=m(!1),K=async()=>{b.value=!0;try{const{list:o}=await Q();_.value=o,h.value={...h.value,total:o.length}}catch(o){console.log(o)}finally{b.value=!1}},f=m(-1),M=A(()=>{if(f.value>-1){const{name:o}=_.value[f.value];return`删除后，${o}的所有合同信息将被清空，且无法恢复`}return""}),N=()=>{f.value=-1},R=()=>{_.value.splice(f.value,1),h.value.total=_.value.length,T.value=!1,se.success("删除成功"),N()},D=()=>{N()};ee(()=>{K()});const B=o=>{f.value=o.row.rowIndex,T.value=!0},L=o=>{console.log(o)},Y=o=>{console.log(o),console.log(u.value)},F=(o,l)=>{console.log("分页变化",o,l)},$=(o,l)=>{console.log("统一Change",o,l)},G=o=>{console.log(o)},z=A(()=>({offsetTop:w.isUseTabsRouter?48:0,container:`.${te}-layout`}));return(o,l)=>{const x=n("t-input"),C=n("t-form-item"),r=n("t-col"),S=n("t-select"),V=n("t-row"),E=n("t-button"),W=n("t-form"),y=n("t-tag"),I=n("t-link"),X=n("t-space"),j=n("t-table"),q=n("t-dialog");return c(),p("div",ie,[t(W,{ref:"form",data:u.value,"label-width":80,colon:"",onReset:L,onSubmit:Y},{default:e(()=>[t(V,null,{default:e(()=>[t(r,{span:10},{default:e(()=>[t(V,{gutter:[24,24]},{default:e(()=>[t(r,{span:4},{default:e(()=>[t(C,{label:"合同名称",name:"name"},{default:e(()=>[t(x,{modelValue:u.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value.name=a),class:"form-item-content",type:"search",placeholder:"请输入合同名称",style:{minWidth:"134px"}},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{span:4},{default:e(()=>[t(C,{label:"合同状态",name:"status"},{default:e(()=>[t(S,{modelValue:u.value.status,"onUpdate:modelValue":l[1]||(l[1]=a=>u.value.status=a),class:"form-item-content",options:s(ae),placeholder:"请选择合同状态",clearable:""},null,8,["modelValue","options"])]),_:1})]),_:1}),t(r,{span:4},{default:e(()=>[t(C,{label:"合同编号",name:"no"},{default:e(()=>[t(x,{modelValue:u.value.no,"onUpdate:modelValue":l[2]||(l[2]=a=>u.value.no=a),class:"form-item-content",placeholder:"请输入合同编号",style:{minWidth:"134px"}},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{span:4},{default:e(()=>[t(C,{label:"合同类型",name:"type"},{default:e(()=>[t(S,{modelValue:u.value.type,"onUpdate:modelValue":l[3]||(l[3]=a=>u.value.type=a),style:{display:"inline-block"},class:"form-item-content",options:s(oe),placeholder:"请选择合同类型",clearable:""},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1}),t(r,{span:2,class:"operation-container"},{default:e(()=>[t(E,{theme:"primary",type:"submit",style:le({marginLeft:"var(--td-comp-margin-s)"})},{default:e(()=>[i(" 查询 ")]),_:1},8,["style"]),t(E,{type:"reset",variant:"base",theme:"default"},{default:e(()=>[i(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),ne("div",ue,[t(j,{data:_.value,columns:O,"row-key":fe,"vertical-align":ye,hover:ve,pagination:h.value,loading:b.value,"header-affixed-top":z.value,onPageChange:F,onChange:$},{status:e(({row:a})=>[a.status===s(v).FAIL?(c(),g(y,{key:0,theme:"danger",variant:"light"},{default:e(()=>[i(" 审核失败 ")]),_:1})):d("",!0),a.status===s(v).AUDIT_PENDING?(c(),g(y,{key:1,theme:"warning",variant:"light"},{default:e(()=>[i(" 待审核 ")]),_:1})):d("",!0),a.status===s(v).EXEC_PENDING?(c(),g(y,{key:2,theme:"warning",variant:"light"},{default:e(()=>[i(" 待履行 ")]),_:1})):d("",!0),a.status===s(v).EXECUTING?(c(),g(y,{key:3,theme:"success",variant:"light"},{default:e(()=>[i(" 履行中 ")]),_:1})):d("",!0),a.status===s(v).FINISH?(c(),g(y,{key:4,theme:"success",variant:"light"},{default:e(()=>[i(" 已完成 ")]),_:1})):d("",!0)]),contractType:e(({row:a})=>[a.contractType===s(k).MAIN?(c(),p("p",de,"审核失败")):d("",!0),a.contractType===s(k).SUB?(c(),p("p",re,"待审核")):d("",!0),a.contractType===s(k).SUPPLEMENT?(c(),p("p",me,"待履行")):d("",!0)]),paymentType:e(({row:a})=>[a.paymentType===s(U).PAYMENT?(c(),p("p",pe,[i(" 付款"),t(P,{class:"dashboard-item-trend",type:"up"})])):d("",!0),a.paymentType===s(U).RECEIPT?(c(),p("p",_e,[i(" 收款"),t(P,{class:"dashboard-item-trend",type:"down"})])):d("",!0)]),op:e(a=>[t(X,null,{default:e(()=>[t(I,{theme:"primary",onClick:H=>G(a)},{default:e(()=>[i("管理")]),_:2},1032,["onClick"]),t(I,{theme:"danger",onClick:H=>B(a)},{default:e(()=>[i("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","pagination","loading","header-affixed-top"]),t(q,{visible:T.value,"onUpdate:visible":l[4]||(l[4]=a=>T.value=a),header:"确认删除当前所选合同？",body:M.value,"on-cancel":D,onConfirm:R},null,8,["visible","body"])])])}}});const Ne=ce(ge,[["__scopeId","data-v-6aa144e7"]]);export{Ne as default};
