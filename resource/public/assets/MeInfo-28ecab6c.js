import{d as C,r as p,I as w,m as r,o as _,e as v,q as o,x as V,M as k,a as l,ar as z,N as c,g as q}from"./index-812ea633.js";const A={name:"MeInfo"},S=C({...A,setup(Z){const s=p(!0),i=w(),e=p({...i.selfInfo}),b=p(null),g={phone:[{validator:n=>/^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/.test(n),message:"手机号格式不正确"}],email:[{required:!1},{validator:n=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(n),message:"邮箱格式不正确"}]},U=()=>{b.value.validate({showErrorMessage:!0}).then(async n=>{var a,m;if(n===!0){await z({id:e.value.id,nickname:e.value.nickname,phone:e.value.phone,email:e.value.email}),c.success("修改成功"),i.getUserInfo(),s.value=!0;return}if(n&&Object.keys(n).length){const f=(m=(a=Object.values(n)[0])==null?void 0:a[0])==null?void 0:m.message;c.warning(f)}})},N=()=>{e.value={...i.selfInfo},s.value=!0},x=()=>{c.success("重置成功")};return(n,a)=>{const m=r("t-button"),f=r("t-icon"),u=r("t-input"),d=r("t-form-item"),y=r("t-form"),M=r("t-space"),I=r("t-card");return _(),v(I,{class:"user-info-list",title:"个人信息",bordered:!1},{actions:o(()=>[s.value===!1?(_(),v(m,{key:0,onClick:U},{default:o(()=>[V("保存")]),_:1})):k("",!0),s.value===!1?(_(),v(m,{key:1,onClick:N},{default:o(()=>[V("取消")]),_:1})):k("",!0),l(m,{theme:"default",shape:"square",variant:"text",onClick:a[0]||(a[0]=t=>s.value=!1)},{default:o(()=>[l(f,{name:"filter-2"})]),_:1})]),default:o(()=>[l(M,{direction:"vertical",size:"large",style:{width:"100%","margin-top":"20px"}},{default:o(()=>[l(y,{ref_key:"form",ref:b,data:e.value,rules:g,"scroll-to-first-error":"smooth",layout:"inline",onReset:x},{default:o(()=>[l(d,{label:"账号",name:"username"},{default:o(()=>[l(u,{modelValue:e.value.username,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.username=t),disabled:!0},null,8,["modelValue"])]),_:1}),l(d,{label:"角色",name:"roleName"},{default:o(()=>[l(u,{modelValue:e.value.roleName,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.roleName=t),disabled:!0},null,8,["modelValue"])]),_:1}),l(d,{label:"上级账号",name:"pUsername"},{default:o(()=>[l(u,{modelValue:e.value.pUsername,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.pUsername=t),disabled:!0},null,8,["modelValue"])]),_:1}),l(d,{label:"上级角色",name:"pRoleName"},{default:o(()=>[l(u,{modelValue:e.value.pRoleName,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.pRoleName=t),disabled:!0},null,8,["modelValue"])]),_:1}),l(d,{label:"昵称",name:"nickname"},{default:o(()=>[l(u,{modelValue:e.value.nickname,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.nickname=t),modelModifiers:{trim:!0},disabled:s.value},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"手机号",name:"phone"},{default:o(()=>[l(u,{modelValue:e.value.phone,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.phone=t),modelModifiers:{trim:!0},disabled:s.value},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"邮箱",name:"email"},{default:o(()=>[l(u,{modelValue:e.value.email,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.email=t),modelModifiers:{trim:!0},disabled:s.value},null,8,["modelValue","disabled"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})}}});const j=q(S,[["__scopeId","data-v-152a50b0"]]);export{j as default};
